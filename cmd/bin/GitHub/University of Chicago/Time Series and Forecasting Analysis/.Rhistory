names(summary(arima(df1[,2],order=c(2,1,3))))
#pdq of (2,1,3) produces AIC of 5175.78
names(summary(arima(df1[,2],order=c(2,1,3))))
#pdq of (2,1,3) produces AIC of 5175.78
summary(arima(df1[,2],order=c(2,1,3)))$aic
#pdq of (2,1,3) produces AIC of 5175.78
arima(df1[,2],order=c(2,1,3))$aic
#pdq of (2,1,3) produces AIC of 5175.78
better_model <- arima(df1[,2],order=c(2,1,3))$aic
#pdq of (2,1,3) produces AIC of 5175.78
better_model <- arima(df1[,2],order=c(2,1,3))
summary(better_model)
AIC(better_model,k = log(length(df1[,2])))
#BIC
AIC(better_model,k = log(length(df1[,2])))
x <- ts(df1[,2],frequency=24)
auto.arima(x)
arima <- auto.arima(x)
?forecast
predict(arima,4)
forecast(arima,4)
predic(arima,4)
predict(arima,4)
forecast(arima,24)
frcst <- forecast(arima,24)
jul1$Date <- format(as.Date(df1$Date,formate='%Y-%m-%d'), "%d")
jul_1 <- readWorksheetFromFile('HW 4/I-57-2013-July-1.csv.xls', sheet='Sheet0', header=T)
jul_1 <- read.csv('HW 4/I-57-2013-July-1.csv', sheet='Sheet0', header=T)
jul_1 <- read.csv('HW 4/I-57-2013-July-1.csv',header=T)
jul_1 <- readWorksheetFromFile('HW 4/I-57-2013-July-1.xls', sheet='Sheet0',header=T)
jul_1 <- readWorksheetFromFile('HW 4/I-57-2013-July-1.xls', sheet='Sheet0',header=T)
jul_1 <- readWorksheetFromFile('HW 4/I-57-2013-July-1.xls', sheet='Sheet0',header=T)
jun_30 <- readWorksheetFromFile('HW 4/I-57-2013-June-30.xls', sheet='Sheet0', header=T)
pacman::p_load(tseries,gdata,XLConnect)
jun_16 <- readWorksheetFromFile('HW 4/I-57-2013-June-16.xls', sheet='Sheet0', header=T)
jun_30 <- readWorksheetFromFile('HW 4/I-57-2013-June-30.xls', sheet='Sheet0', header=T)
jul_1 <- read.table('HW 4/I-57-2013-July-1.csv.xls', sheet='Sheet0', header=T)
jul_1 <- read.table('HW 4/I-57-2013-July-1.csv.xls',  header=T)
library(readxl)
dataset <- read_excel(NULL)
View(dataset)
pacman::p_load(tseries,gdata,XLConnect,forecast)
jun_16 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-16.xls', sheet='Sheet0', header=T)
jun_16$Date <- as.Date('2013-06-16')
jun_17 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-17.xls', sheet='Sheet0', header=T)
jun_17$Date <- as.Date('2013-06-17')
jun_18 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-18.xls', sheet='Sheet0', header=T)
jun_18$Date <- as.Date('2013-06-18')
jun_19 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-19.xls', sheet='Sheet0', header=T)
jun_19$Date <- as.Date('2013-06-19')
jun_20 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-20.xls', sheet='Sheet0', header=T)
jun_20$Date <- as.Date('2013-06-20')
jun_21 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-21.xls', sheet='Sheet0', header=T)
jun_21$Date <- as.Date('2013-06-21')
jun_22 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-22.xls', sheet='Sheet0', header=T)
jun_22$Date <- as.Date('2013-06-22')
jun_23 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-23.xls', sheet='Sheet0', header=T)
jun_23$Date <- as.Date('2013-06-23')
jun_24 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-24.xls', sheet='Sheet0', header=T)
jun_24$Date <- as.Date('2013-06-24')
jun_25 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-25.xls', sheet='Sheet0', header=T)
jun_25$Date <- as.Date('2013-06-25')
jun_26 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-26.xls', sheet='Sheet0', header=T)
jun_26$Date <- as.Date('2013-06-26')
jun_27 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-27.xls', sheet='Sheet0', header=T)
jun_27$Date <- as.Date('2013-06-27')
jun_28 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-28.xls', sheet='Sheet0', header=T)
jun_28$Date <- as.Date('2013-06-28')
jun_29 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-29.xls', sheet='Sheet0', header=T)
jun_29$Date <- as.Date('2013-06-29')
jun_30 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-30.xls', sheet='Sheet0', header=T)
jun_30$Date <- as.Date('2013-06-30')
jul_1 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-July-1.xls', sheet='Sheet0', header=T)
jul_1$Date <- as.Date('2013-07-01')
head(jun_16)
head(jun_16[,c(3,4)])
head(jun_16[,c(3,5)])
head(jun_16[,c(3,5)])
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
df1<- df
df1$Date <- format(as.Date(df1$Date,formate='%Y-%m-%d'), "%d")
jul_1$Date <- format(as.Date(jul_1$Date,formate='%Y-%m-%d'), "%d")
df1[,2] <- as.numeric(df1[,2])
jul_1[,2] <- as.numeric(jul_1$Date)
auto.arima(df1[,2])
df1
auto.arima(df1[,2])
#pdq of (1,0,3) produces AIC of 5224.24
arima(df1[,2],order=c(1,0,3))
#pdq of (1,0,3) produces AIC of 5224.24
arima(df1[,2],order=c(3,0,3))
#pdq of (3,0,3) produces AIC of 5190.22
arima(df1[,2],order=c(4,0,4))
#pdq of (3,0,3) produces AIC of 5190.22
arima(df1[,2],order=c(4,1,4))
#pdq of (3,0,3) produces AIC of 5190.22
arima(df1[,2],order=c(4,1,3))
#pdq of (3,0,3) produces AIC of 5190.22
arima(df1[,2],order=c(4,1,5))
#pdq of (2,1,3) produces AIC of 5175.78
better_model <- arima(df1[,2],order=c(4,1,3))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(4,1,3)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(4,1,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(3,1,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(3,1,3)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(3,1,4)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(4,2,3)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(7,0,3)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(7,1,3)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(7,0,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(7,0,1)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(7,0,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(8,0,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(10,0,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(9,0,2)))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(8,0,2)))
#BIC
AIC(better_model,k = log(length(df1[,2])))
x <- ts(df1[,2],frequency=24)
arima <- auto.arima(x)
(frcst_2 <- forecast(arima,24))
df3 <- subset(df1, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
x <- ts(df3[,2],frequency=4)
(arima3 <- auto.arima(x))
(frcst_3 <- forecast(arima3,4))
names(frcst_3)
frcst_3$mean
df4 <- jul_1[3:26,c(3,4,88)]
df4 <- subset(df4, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
head(df)
?as.data
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df_final$Actual <- as.double(df_final$Actual)
df_final$Part_2 <- as.double(df_final$Part_2)
df_final$Part_3 <- as.double(df_final$Part_3)
df_final$Part_3_diff <- df_final$Actual - df_final$Part_3
(df_final$Part_2_diff <- df_final$Actual - df_final$Part_2)
df_final
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df4 <- jul_1[3:26,c(3,4,88)]
df4 <- subset(df4, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
head(df)
?as.data
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df_final
df_final$Actual <- as.double(df_final$Actual)
df_final$Part_2 <- as.double(df_final$Part_2)
df_final$Part_3 <- as.double(df_final$Part_3)
df_final$Part_3_diff <- df_final$Actual - df_final$Part_3
(df_final$Part_2_diff <- df_final$Actual - df_final$Part_2)
df4 <- jul_1[3:26,c(3,4,88)]
df4 <- subset(df4, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
head(df)
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df_final
#df_final$Actual <- as.double(df_final$Actual)
#df_final$Part_2 <- as.double(df_final$Part_2)
#df_final$Part_3 <- as.double(df_final$Part_3)
#df_final$Part_3_diff <- df_final$Actual - df_final$Part_3
#(3df_final$Part_2_diff <- df_final$Actual - df_final$Part_2)
df
df4 <- jul_1[3:26,c(3,5,88)]
df4 <- subset(df4, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
head(df)
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df_final
df_final1 <- as.data.frame()
df_final1 <- as.data.frame()
df_final1 <- as.data.frame(c())
df_final
df_final1 <- as.data.frame(cbind(c(1233, 1110,1142,1129),c(818.7,888.3,1064.1,1014.4),c(442.6,585.4,1144.9,945.1))
df_final1
df_final1 <- as.data.frame(cbind(c(1233, 1110,1142,1129),c(818.7,888.3,1064.1,1014.4),c(442.6,585.4,1144.9,945.1)))
df_final1
colnames(df_final1) <- c('Actual',"Part_3", "Part_2")
df_final1.head()
head(df_final1)
df_final1$Part_3_diff <- df_final1$Actual - df_final1$Part_3
df_final1$Part_2_diff <- df_final1$Actual - df_final1$Part_2)
(df_final1$Part_2_diff <- df_final1$Actual - df_final1$Part_2)
df_final1
knitr::opts_chunk$set(echo = TRUE)
if(!"pacman" %in% rownames(installed.packages())) {
install.packages("pacman")
}
pacman::p_load(tseries,gdata,XLConnect,forecast)
head(jun_16[,c(3,5)])
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
jun_16 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-16.xls', sheet='Sheet0', header=T)
jun_16$Date <- as.Date('2013-06-16')
jun_17 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-17.xls', sheet='Sheet0', header=T)
jun_17$Date <- as.Date('2013-06-17')
jun_18 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-18.xls', sheet='Sheet0', header=T)
jun_18$Date <- as.Date('2013-06-18')
jun_19 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-19.xls', sheet='Sheet0', header=T)
jun_19$Date <- as.Date('2013-06-19')
jun_20 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-20.xls', sheet='Sheet0', header=T)
jun_20$Date <- as.Date('2013-06-20')
jun_21 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-21.xls', sheet='Sheet0', header=T)
jun_21$Date <- as.Date('2013-06-21')
jun_22 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-22.xls', sheet='Sheet0', header=T)
jun_22$Date <- as.Date('2013-06-22')
jun_23 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-23.xls', sheet='Sheet0', header=T)
jun_23$Date <- as.Date('2013-06-23')
jun_24 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-24.xls', sheet='Sheet0', header=T)
jun_24$Date <- as.Date('2013-06-24')
jun_25 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-25.xls', sheet='Sheet0', header=T)
jun_25$Date <- as.Date('2013-06-25')
jun_26 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-26.xls', sheet='Sheet0', header=T)
jun_26$Date <- as.Date('2013-06-26')
jun_27 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-27.xls', sheet='Sheet0', header=T)
jun_27$Date <- as.Date('2013-06-27')
jun_28 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-28.xls', sheet='Sheet0', header=T)
jun_28$Date <- as.Date('2013-06-28')
jun_29 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-29.xls', sheet='Sheet0', header=T)
jun_29$Date <- as.Date('2013-06-29')
jun_30 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-30.xls', sheet='Sheet0', header=T)
jun_30$Date <- as.Date('2013-06-30')
jul_1 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-July-1.xls', sheet='Sheet0', header=T)
jul_1$Date <- as.Date('2013-07-01')
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
df1<- df
df1$Date <- format(as.Date(df1$Date,formate='%Y-%m-%d'), "%d")
jul_1$Date <- format(as.Date(jul_1$Date,formate='%Y-%m-%d'), "%d")
df1[,2] <- as.numeric(df1[,2])
jul_1[,2] <- as.numeric(jul_1$Date)
auto.arima(df1[,2])
?auto.arima
knitr::opts_chunk$set(echo = TRUE)
if(!"pacman" %in% rownames(installed.packages())) {
install.packages("pacman")
}
pacman::p_load(tseries,gdata,XLConnect,forecast)
#pdq of (1,0,3) produces AIC of 4308.36
arima(df1[,2],order=c(3,0,3))
jun_16 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-16.xls', sheet='Sheet0', header=T)
jun_16$Date <- as.Date('2013-06-16')
jun_17 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-17.xls', sheet='Sheet0', header=T)
jun_17$Date <- as.Date('2013-06-17')
jun_18 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-18.xls', sheet='Sheet0', header=T)
jun_18$Date <- as.Date('2013-06-18')
jun_19 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-19.xls', sheet='Sheet0', header=T)
jun_19$Date <- as.Date('2013-06-19')
jun_20 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-20.xls', sheet='Sheet0', header=T)
jun_20$Date <- as.Date('2013-06-20')
jun_21 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-21.xls', sheet='Sheet0', header=T)
jun_21$Date <- as.Date('2013-06-21')
jun_22 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-22.xls', sheet='Sheet0', header=T)
jun_22$Date <- as.Date('2013-06-22')
jun_23 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-23.xls', sheet='Sheet0', header=T)
jun_23$Date <- as.Date('2013-06-23')
jun_24 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-24.xls', sheet='Sheet0', header=T)
jun_24$Date <- as.Date('2013-06-24')
jun_25 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-25.xls', sheet='Sheet0', header=T)
jun_25$Date <- as.Date('2013-06-25')
jun_26 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-26.xls', sheet='Sheet0', header=T)
jun_26$Date <- as.Date('2013-06-26')
jun_27 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-27.xls', sheet='Sheet0', header=T)
jun_27$Date <- as.Date('2013-06-27')
jun_28 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-28.xls', sheet='Sheet0', header=T)
jun_28$Date <- as.Date('2013-06-28')
jun_29 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-29.xls', sheet='Sheet0', header=T)
jun_29$Date <- as.Date('2013-06-29')
jun_30 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-30.xls', sheet='Sheet0', header=T)
jun_30$Date <- as.Date('2013-06-30')
jul_1 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-July-1.xls', sheet='Sheet0', header=T)
jul_1$Date <- as.Date('2013-07-01')
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
df1<- df
df1$Date <- format(as.Date(df1$Date,formate='%Y-%m-%d'), "%d")
jul_1$Date <- format(as.Date(jul_1$Date,formate='%Y-%m-%d'), "%d")
df1[,2] <- as.numeric(df1[,2])
jul_1[,2] <- as.numeric(jul_1$Date)
auto.arima(df1[,2])
#pdq of (1,0,3) produces AIC of 4308.36
arima(df1[,2],order=c(3,0,3))
#pdq of (3,0,3) produces AIC of 4303
arima(df1[,2],order=c(4,1,5))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(8,0,2)))
#BIC
AIC(better_model,k = log(length(df1[,2])))
(arima <- auto.arima(x))
x <- ts(df1[,2],frequency=24)
(arima <- auto.arima(x))
(frcst_2 <- forecast(arima,24))
df3 <- subset(df1, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
x <- ts(df3[,2],frequency=4)
(arima3 <- auto.arima(x))
(frcst_3 <- forecast(arima3,4))
names(frcst_3)
frcst_3$mean
df4 <- jul_1[3:26,c(3,5,88)]
df4 <- subset(df4, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
head(df)
df_final <- as.data.frame(cbind("Actual"=df4[,2],"Part_3"=as.numeric(frcst_3$mean),"Part_2"=as.numeric(frcst_2$fitted[c(8,9,17,18)])))
df_final
df_final1 <- as.data.frame(cbind(c(1233, 1110,1142,1129),c(818.7,888.3,1064.1,1014.4),c(442.6,585.4,1144.9,945.1)))
colnames(df_final1) <- c('Actual',"Part_3", "Part_2")
df_final1$Part_3_diff <- df_final1$Actual - df_final1$Part_3
df_final1$Part_2_diff <- df_final1$Actual - df_final1$Part_2
df_final1 %>%
summarise
df_final1
df_final1 <- as.data.frame(cbind(c(1233, 1110,1142,1129),c(818.7,888.3,1064.1,1014.4),c(442.6,585.4,1144.9,945.1)))
colnames(df_final1) <- c('Actual',"Part_3", "Part_2")
df_final1$Part_3_diff <- (df_final1$Actual - df_final1$Part_3)^2
df_final1$Part_2_diff <- (df_final1$Actual - df_final1$Part_2)^2
df_final1
sapply(df_final1,2,sum(x))
lapply(df_final1,2,sum(x))
apply(df_final1,2,sum(x))
?appy
?apply
apply(df_final1[,c(3,4)],2,sum())
apply(df_final1,2,sum())
apply(df_final1,2,sum)
?auto.arima
knitr::opts_chunk$set(echo = TRUE)
if(!"pacman" %in% rownames(installed.packages())) {
install.packages("pacman")
}
pacman::p_load(tseries,gdata,XLConnect,forecast)
jun_16 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-16.xls', sheet='Sheet0', header=T)
jun_16$Date <- as.Date('2013-06-16')
jun_17 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-17.xls', sheet='Sheet0', header=T)
jun_17$Date <- as.Date('2013-06-17')
jun_18 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-18.xls', sheet='Sheet0', header=T)
jun_18$Date <- as.Date('2013-06-18')
jun_19 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-19.xls', sheet='Sheet0', header=T)
jun_19$Date <- as.Date('2013-06-19')
jun_20 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-20.xls', sheet='Sheet0', header=T)
jun_20$Date <- as.Date('2013-06-20')
jun_21 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-21.xls', sheet='Sheet0', header=T)
jun_21$Date <- as.Date('2013-06-21')
jun_22 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-22.xls', sheet='Sheet0', header=T)
jun_22$Date <- as.Date('2013-06-22')
jun_23 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-23.xls', sheet='Sheet0', header=T)
jun_23$Date <- as.Date('2013-06-23')
jun_24 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-24.xls', sheet='Sheet0', header=T)
jun_24$Date <- as.Date('2013-06-24')
jun_25 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-25.xls', sheet='Sheet0', header=T)
jun_25$Date <- as.Date('2013-06-25')
jun_26 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-26.xls', sheet='Sheet0', header=T)
jun_26$Date <- as.Date('2013-06-26')
jun_27 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-27.xls', sheet='Sheet0', header=T)
jun_27$Date <- as.Date('2013-06-27')
jun_28 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-28.xls', sheet='Sheet0', header=T)
jun_28$Date <- as.Date('2013-06-28')
jun_29 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-29.xls', sheet='Sheet0', header=T)
jun_29$Date <- as.Date('2013-06-29')
jun_30 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-June-30.xls', sheet='Sheet0', header=T)
jun_30$Date <- as.Date('2013-06-30')
jul_1 <- readWorksheetFromFile('C:/Users/u353822/Documents/Git/bin/GitHub/University of Chicago/Time Series and Forecasting Analysis/HW 4//I-57-2013-July-1.xls', sheet='Sheet0', header=T)
jul_1$Date <- as.Date('2013-07-01')
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
df <- rbind(jun_16[3:26,c(3,5,88)],
jun_17[3:26,c(3,5,88)],
jun_18[3:26,c(3,5,88)],
jun_19[3:26,c(3,5,88)],
jun_20[3:26,c(3,5,88)],
jun_21[3:26,c(3,5,88)],
jun_22[3:26,c(3,5,88)],
jun_23[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_25[3:26,c(3,5,88)],
jun_26[3:26,c(3,5,88)],
jun_27[3:26,c(3,5,88)],
jun_28[3:26,c(3,5,88)],
jun_29[3:26,c(3,5,88)],
jun_30[3:26,c(3,5,88)])
df1<- df
df1$Date <- format(as.Date(df1$Date,formate='%Y-%m-%d'), "%d")
jul_1$Date <- format(as.Date(jul_1$Date,formate='%Y-%m-%d'), "%d")
df1[,2] <- as.numeric(df1[,2])
jul_1[,2] <- as.numeric(jul_1$Date)
auto.arima(df1[,2])
#pdq of (1,0,3) produces AIC of 4308.36
arima(df1[,2],order=c(3,0,3))
#pdq of (3,0,3) produces AIC of 4303
arima(df1[,2],order=c(4,1,5))
#pdq of (2,1,3) produces AIC of 5175.78
(better_model <- arima(df1[,2],order=c(8,0,2)))
#BIC
AIC(better_model,k = log(length(df1[,2])))
#BIC
summary(better_model
#BIC
summary(better_model)
#BIC
summary(better_model)
BIC(better_model,k = log(length(df1[,2])))
BIC(better_model)
#BIC
AICc(better_model)
??AICc
pacman::p_load(tseries,gdata,XLConnect,forecast,MuMIn)
#BIC
AICc(better_model)
BIC(better_model)
x <- ts(df1[,2],frequency=24)
(arima <- auto.arima(x))
(frcst_2 <- forecast(arima,24))
?auto.arima
x <- ts(df1[,2],frequency=24)
(arima <- auto.arima(x))
df1[,2]
df1
x <- ts(df1[,2],frequency=24)
(arima <- auto.arima(x))
df3 <- subset(df1, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
x <- ts(df3[,2],frequency=4)
(arima3 <- auto.arima(x))
(frcst_3 <- forecast(arima3,4))
names(frcst_3)
frcst_3$mean
df3 <- subset(df1, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
x <- ts(df3[,2],frequency=4)
(arima3 <- auto.arima(x))
(frcst_3 <- forecast(arima3,4))
names(frcst_3)
frcst_3$mean
df3 <- subset(df1, Time == '08:00' | Time == '09:00' | Time == '17:00' | Time == '18:00')
x <- ts(df3[,2],frequency=4)
(arima3 <- auto.arima(x))
(frcst_3 <- forecast(arima3,4))
frcst_3$mean
