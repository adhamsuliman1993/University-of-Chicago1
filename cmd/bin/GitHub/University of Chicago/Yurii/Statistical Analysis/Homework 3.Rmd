---
title: "Homework 3By: Adham Suliman"
output: html_document
---

Model 1
Simulate and plot Model1: input variable X ~ Norm(??=3,??=2.5); model residuals Eps ~ Norm(??=0,??=1.5)
Use set.seed(111) to simulate X and set.seed(1112131415) to simulate Eps.
```{r 1.1}
a<-.8
b<-.1
nSample<-1000
set.seed(111)
LinearModel1$X <- rnorm(n=nSample,mean= 3, sd= 2.5)
set.seed(1112131415)
LinearModel1$Eps <- rnorm(n=nSample, mean=0, sd=1.5)
LinearModel1$Y <- a*LinearModel1$X +b + LinearModel1$Eps
head(LinearModel1)

plot(LinearModel1$X,LinearModel1$Y)

plot(LinearModel1$Eps,type="l")


```
Model 2
Simulate and plot Model2: input variable X ~ Norm(??=3,??=2.5); model residuals Eps ~ Unif(min=???4.33,max=4.33).
Use the same realization of X as in the first model.
```{R Model 2}
nSample<-1000
set.seed(111)
LinearModel2<-matrix()
LinearModel2$X <- rnorm(n=nSample,mean= 3, sd= 2.5)
set.seed(1112131415)
LinearModel2$Eps <- runif(n=nSample,max=4.33,min=-4.33)
LinearModel2$Y <- a*LinearModel2$X +b + LinearModel2$Eps

plot(LinearModel2$X,LinearModel2$Y)

plot(LinearModel2$Eps,type="l")
```

Model 3
Simulate and plot Model3: input variable X ~ Norm^(??=3,??=2.5); model residuals Eps ~ Cauchi*(location=0,scale=0.3).
Use the same realization of X as in the first model.
```{R Model 3}
nSample<-1000
set.seed(111)
LinearModel3<-matrix()
LinearModel3$X <- rnorm(n=nSample,mean= 3, sd= 2.5)
set.seed(1112131415)
LinearModel3$Eps <- rcauchy(n=nSample,location=0,scale=.3)
LinearModel3$Y <- a*LinearModel3$X +b + LinearModel3$Eps

plot(LinearModel3$X,LinearModel3$Y)

plot(LinearModel3$Eps,type="l")
```

Model 4
Simulate and plot Model4: input variable X ~ Norm(??=3,??=2.5); model residuals Eps ~ a heteroscedastic process.
Use the same realization of X as in the first model.
```{R Model 4}

sd.Values<-c(2,3.4,.8,2.6)
sd.process<-rep(c(rep(sd.Values[1],50),
                  rep(sd.Values[2],75),
                  rep(sd.Values[3],75),
                  rep(sd.Values[4],50)),4)
            
plot(sd.process,type="l")

set.seed(1112131415)
Eps<-rnorm(nSample)*sd.process
plot(Eps,type="l")

Xvariable<-(100*floor(min(Eps))):(100*ceiling(max(Eps)))
Xvariable<-Xvariable/100

plot(Xvariable,dnorm(Xvariable,mean=mean(Eps),sd=sd(Eps)),type="l",
      ylim=c(0,.3),col="black",ylab="Distribution of Eps",xlab="")
lines(density(Eps),col="red")

nSample<-1000
set.seed(111)
LinearModel4<-matrix()
LinearModel4$X <- rnorm(n=nSample,mean= 3, sd= 2.5)
LinearModel4$Y <- a*LinearModel4$X +b + Eps


plot(LinearModel4$X,LinearModel4$Y)
```

Model 5: Effect of Risidual Distribution on Correlation

```{R Model 5}
Theoretical.Rho.Squared<-(a*2.5)^2/((a*2.5)^2+1.5^2)
Theoretical.Rho.Squared

c(cor(LinearModel1$X,LinearModel1$Y)^2,
  cor(LinearModel2$X,LinearModel2$Y)^2,
  cor(LinearModel3$X,LinearModel3$Y)^2,
  cor(LinearModel4$X,LinearModel4$Y)^2)
```

How do you interpret the results?
The sample moment for LinearModel 1 is very close to the theoretical moment, yet all the other sample moments are very far from both Linearmodel1 and the theoretical moment. 

Estimation of Linear Model
```{R Model 6}
m1<-lm(Y~X,data=LinearModel1)
summary(m1)
```




